{"version":3,"sources":["chartCommons.js"],"names":["define","getFullName","s","name","operation","renamed","op","getAggIndex","groups","aggs","aggIndex","length","_","findIndex","field","activateTooltip","$scope","$timeout","p","chartTooltip","resetTimeout","options","otherChart","result","o","vizSummary","xAxisShows","key","toLowerCase","gridApi","find","grid","columns","color","point","active","viewData","byColumn","byValue","row","entity","values","map","gridOptions","columnDefs","col","value","displayName","isRegressionLine","chartType","CHART_TYPES","SCATTER","series","userOptions","type","headerData","y","activateVisible","activateEvents","$apply","updatePosition","COLUMN","BAR","PIE","LINE","AREA","MAP","TABLE","LIST","REGRESSION_TYPES","LINEAR","EXPONENTIAL","LOGARITHMIC","POWER","POLYNOMIAL","REGRESSION_TYPE_OPTIONS","desc","defaultChartOptions","rawData","$filter","activeClick","chart","renderTo","events","load","expandOnDrillDown","inRequestViz","click","e","chartTypes","hoverPoint","stopPropagation","bind","hoverSeries","resetZoomButton","theme","fill","stroke","style","r","states","hover","cursor","exporting","enabled","title","text","display","subtitle","plotOptions","mouseOver","target","data","mainValueKey","push","category","index","forEach","item","segmentBy","yAxisShows","shows","slice","el","searchName","dataSummary","filter","customFilter","showName","aggregation","deactivateEvents","controllerName","mouseOut","hidePromise","hide","xAxis","labels","formatter","popupData","is","vr","empty","core","getVisibleRows","d","val","allData","__treeLevel","navigator","includeInCSVExport","rangeSelector","legend","useHTML","yAxis","credits","tooltip","modalClass","visible","isEnableEvents","direction","showData","popup","update","closeData","that","chartContainer","$","offset","left","tooltipPos","plotX","top","plotY","arrowLeftPosition","width","plotLeft","height","enabledMultiAxis","plotTop","leftOutside","rightOutside","modalOffset","css","cancel","isAllowedDataForChartType","colsTypes","cols","hltd","indexOf","calculateCoordsForRegressions","regressionType","regData","calculateY","equation","x","i","Math","pow","minY","plusY","exp","log","maxY","minX","maxX","plusX","forCalc","JSON","stringify","string","r2","toFixed","parseFloat","concat","removeCalculate","str","startIndex","endIndex"],"mappings":"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","file":"../chartCommons.js","sourcesContent":["define([], function() {\n    var CHART_TYPES = {\n        COLUMN: 0,\n        BAR: 1,\n        PIE: 2,\n        LINE: 3,\n        AREA: 4,\n        MAP: 5,\n        SCATTER: 6,\n        TABLE: 7,\n        LIST: 8\n    };\n    var REGRESSION_TYPES = {\n        LINEAR: 0,\n        EXPONENTIAL: 1,\n        LOGARITHMIC: 2,\n        POWER: 3,\n        POLYNOMIAL: 4\n    };\n    var REGRESSION_TYPE_OPTIONS = [\n        {desc: 'Linear', value: REGRESSION_TYPES.LINEAR},\n        {desc: 'Exponential', value: REGRESSION_TYPES.EXPONENTIAL},\n        {desc: 'Logarithmic', value: REGRESSION_TYPES.LOGARITHMIC},\n        {desc: 'Power', value: REGRESSION_TYPES.POWER},\n        {desc: 'Polynomial', value: REGRESSION_TYPES.POLYNOMIAL}\n    ];\n\n    function getFullName(s){\n        var name = s.name;\n        if(s.operation && !s.renamed){\n            name += ' (' + s.op.name + ')';\n        }\n        return name;\n    }\n\n    function getAggIndex(groups, aggs){\n        var aggIndex = 0;\n        if(groups.length){\n            aggIndex = _.findIndex(aggs, {field: groups[0].field});\n            if(aggIndex < 0){\n                aggIndex = 0;\n            }\n        }\n        return aggIndex;\n    }\n\n    function activateTooltip($scope, $timeout, p) {\n\n        $scope.chartTooltip.resetTimeout();\n\n        if(!p.options.otherChart) {\n            var result = p.o;\n\n            var field;\n            if ($scope.vizSummary.xAxisShows[0].key != \"$$row_number\") {\n                field = $scope.vizSummary.xAxisShows[0].key;\n            } else {\n                field = this.options.key || this.options.name.toLowerCase();\n            }\n\n\n            var key;\n            if ($scope.gridApi) {\n                key = _.find($scope.gridApi.grid.columns, {field: field});\n            }\n\n            $scope.chartTooltip.color = p.color;\n            $scope.chartTooltip.point = p;\n            $scope.chartTooltip.active = true;\n            $scope.chartTooltip.viewData = false;\n            $scope.chartTooltip.byColumn = key;\n            $scope.chartTooltip.byValue = result[field];\n            $scope.chartTooltip.row = key ? undefined : {entity: p.o};\n            $scope.chartTooltip.values = _.map($scope.gridOptions.columnDefs, function(col){\n                var value = p.o[col.name];\n                return { name: col.displayName, value: value }\n            });\n\n            if ($scope.vizSummary.chartType === CHART_TYPES.SCATTER) {\n                $scope.chartTooltip.isRegressionLine = p.series.userOptions.type === 'spline'\n            } else {\n                $scope.chartTooltip.isRegressionLine = false;\n            }\n\n            $scope.chartTooltip.headerData = [{\n                key: p.name || p.series.name,\n                value: p.y\n            }];\n\n            $scope.chartTooltip.activateVisible();\n            $scope.chartTooltip.activateEvents();\n            $scope.$apply();\n\n\n            $timeout(function () {\n                $scope.chartTooltip.updatePosition(p);\n            });\n        }\n    }\n\n    function defaultChartOptions(rawData, $scope, $timeout, $filter, activeClick) {\n        return {\n            chart: {\n                renderTo: 'chart-container',\n                events: {\n                    load: function (e) {\n                        if(!$scope.expandOnDrillDown) {\n                            $scope.inRequestViz = false;\n                        }\n                    },\n                    click: function (e) {\n                        if (activeClick && $scope.chartType != $scope.chartTypes.SCATTER) return;\n\n                        if (!$scope.chartTooltip.active && this.hoverPoint) {\n                            e.stopPropagation();\n                            activateTooltip.bind(this.hoverSeries, $scope, $timeout, this.hoverPoint)();\n                        }\n                    }\n                },\n                resetZoomButton: {\n                    theme: {\n                        fill: '#f8f8f8',\n                        stroke: '#ccc',\n                        style: {\n                            color: '#333'\n                        },\n                        r: 1,\n                        states: {\n                            hover: {\n                                fill: '#e7e7e7',\n                                stroke: '#adadad',\n                                style: {\n                                    color: 'black',\n                                    cursor: 'pointer'\n                                }\n                            }\n                        }\n                    }\n                }\n            },\n            exporting: {\n                enabled: false\n            },\n            title: {\n                text: '',\n                style: {\n                    display: 'none'\n                }\n            },\n            subtitle: {\n                text: '',\n                style: {\n                    display: 'none'\n                }\n            },\n            plotOptions: {\n                series: {\n                    point: {\n                        events: {\n                            mouseOver: function (e) {\n\n                                if (!$scope.chartTooltip.active) {\n                                    $scope.chartTooltip.resetTimeout();\n                                    $scope.chartTooltip.value = null;\n\n                                    var p = e.target,\n                                        data = [],\n                                        type = rawData ? rawData.vizSummary.chartType : $scope.vizSummary.chartType,\n                                        mainValueKey = rawData\n                                            ? rawData.vizSummary.xAxisShows[0].field\n                                            : $scope.vizSummary.xAxisShows[0].field;\n\n                                    if (type === CHART_TYPES.PIE) {\n                                        data.push({\n                                            key: (type === CHART_TYPES.PIE) ? p.name : p.series.name,\n                                            value: p.y\n                                        });\n                                    } else if (type === CHART_TYPES.SCATTER) {\n                                        var category = p.index;\n\n                                        p.series.chart.series.forEach(function (item) {\n                                            if (item.name == 'Navigator' || !item.data.length || !item.data[category] || !item.data[category].y) return;\n\n                                            data.push({\n                                                value: item.data[category].y,\n                                                key: item.name,\n                                                color: item.color\n                                            });\n                                        });\n\n                                        // add header value\n                                        $scope.chartTooltip.value = p.category;\n                                    } else {\n\n                                        if (rawData ? rawData.segmentBy.length : $scope.vizSummary.segmentBy.length) {\n\n                                            var key = rawData ?\n                                                rawData.yAxisShows[0].key :\n                                                $scope.vizSummary.yAxisShows[0].key;\n                                            var category = p.category;\n\n                                            p.series.chart.series.forEach(function (item) {\n                                                if (item.name == 'Navigator' || !item.data[category].options.y) return;\n\n                                                data.push({\n                                                    value: item.data[category].options.y,\n                                                    key: item.name,\n                                                    color: item.color\n                                                });\n                                            });\n\n                                        } else {\n\n                                            // add limit\n                                            var shows = rawData ? rawData.yAxisShows.slice(0, 6) : $scope.vizSummary.yAxisShows.slice(0, 6);\n\n                                            shows.forEach(function (el) {\n                                                var searchName = (rawData ? rawData.aggs.length : $scope.dataSummary.aggs.length)\n                                                    ? getFullName(el)\n                                                    : el.name;\n\n                                                var color = _.find(p.series.chart.series, {name: searchName});\n                                                if (color) color = color.color;\n\n                                                var filter = _.find($scope.gridOptions.columnDefs, {field: el.key});\n                                                if (filter) filter = filter.customFilter;\n\n                                                var value;\n                                                // if (filter && filter.type) {\n                                                //     value = $filter('pickerFilter')(p.o[el.key], filter);\n                                                // } else {\n                                                    value = p.o[el.key];\n                                                // }\n\n                                                data.push({\n                                                    value: value,\n                                                    key: el.showName,\n                                                    color: color\n                                                });\n                                            });\n                                        }\n                                        \n                                        $scope.chartTooltip.value = (mainValueKey == \"$$row_number\")\n                                            ? p.category\n                                            : p.o[mainValueKey];\n\n                                        if (!$scope.chartTooltip.value) {\n                                            $scope.chartTooltip.value = p.o.aggregation;\n                                        }\n                                    }\n\n                                    $scope.chartTooltip.headerData = data;\n                                    $scope.chartTooltip.color = e.target.color;\n                                    $scope.chartTooltip.deactivateEvents();\n                                    $scope.chartTooltip.activateVisible();\n\n                                    $scope.$apply();\n\n                                    $timeout(function () {\n                                        $scope.chartTooltip.updatePosition(e.target);\n                                    });\n                                }\n                            }\n                        }\n                    },\n                    events: {\n                        click: function (e) {\n                            if (activeClick && $scope.chartType != $scope.chartTypes.SCATTER && $scope.controllerName != 'visualizationCtrl') return;\n\n                            e.stopPropagation();\n                            activateTooltip.bind(this, $scope, $timeout, e.point)();\n                        },\n                        mouseOut: function(e) {\n                            if (!$scope.chartTooltip.active) {\n                                $scope.chartTooltip.hidePromise = $timeout(function () {\n                                    $scope.chartTooltip.hide();\n                                }, 250);\n                            }\n                        }\n                    }\n                }\n            },\n            xAxis: {\n                labels: {\n                    formatter: function() {\n                        if(!rawData && $scope.popupData && $scope.popupData.is || !$scope.gridApi) return;\n\n                        var vr = [];\n                        if (!rawData){\n                            rawData = {\n                                vizSummary: {},\n                                dataSummary: {},\n                                empty: true\n                            };\n\n                            if ($scope.gridApi) {\n                                vr = $scope.gridApi.core.getVisibleRows();\n                            }\n                        }\n\n                        var d = {\n                            xAxisShows: rawData.vizSummary.xAxisShows || $scope.vizSummary.xAxisShows,\n                            chartType: rawData.vizSummary.chartType || $scope.vizSummary.chartType,\n                            columnDefs: $scope.gridOptions.columnDefs,\n                            data: vr.length ? _.map(vr, 'entity') : $scope.gridOptions.data,\n                            aggs: rawData.dataSummary.aggs || $scope.dataSummary.aggs\n                        };\n                        if (rawData.empty) rawData = null;\n\n\n\n                        if (d.xAxisShows[0]) {\n\n                            var key = d.xAxisShows[0].field,\n                                type, val;\n\n                            if (key == \"$$row_number\" || (d.chartType) == CHART_TYPES.SCATTER) {\n                                val = this.value;\n                            } else {\n\n                                if(!_.find((d.columnDefs), {field: key}) && !_.find((d.aggs), {field: key})) return;\n\n                                if (d.aggs.length == 0) {\n                                    type = _.find(d.columnDefs, {field: key}).type;\n                                } else {\n                                    type = _.find(d.aggs, {field: key}).type;\n                                }\n                                var aggIndex = getAggIndex((d.xAxisShows), (d.aggs));\n                                var allData = _.filter(d.data, function(o) {\n                                    return o.__treeLevel == aggIndex;\n                                });\n                                var data = allData[this.value];\n                                if (data) {\n                                    val = data.aggregation || data[key];\n                                    if (val != null) {\n                                        if (type === 'daterange') {\n                                            var operation = d.xAxisShows[0].operation;\n\n                                            if(operation && operation == 'year') {\n                                                val = $filter('date')(data[(d.xAxisShows[0].key)], 'y');\n                                            } else {\n                                                val = $filter('date')(val, 'MMM d, y');\n                                            }\n                                        }\n                                    } else {\n                                        val = \"null\"\n                                    }\n                                }\n                            }\n                            return val;\n                        }\n                    }\n                }\n            },\n            navigator: {\n                series: {\n                    includeInCSVExport: false\n                },\n                xAxis: {\n                    labels: {\n                        formatter: function() {\n                            return '';\n                        }\n                    }\n                }\n            },\n            rangeSelector: {\n                enabled: false\n            },\n            legend: {\n                enabled: true,\n                useHTML: true\n            },\n            yAxis: {},\n            series: [],\n            credits: {\n                enabled: false\n            },\n            tooltip: {\n                enabled: false\n            }\n        }\n    }\n\n    function chartTooltip(rawData, $scope, $timeout, modalClass) {\n        return {\n            // triggers\n            visible: false,\n            active: false,\n            isEnableEvents: true,\n            viewData: false,\n\n            // data\n            point: null,\n            byColumn: null,\n            byValue: null,\n            color: null,\n            headerData: [],\n            hidePromise: null,\n            direction: null,\n\n            // methods\n            showData: function(){\n                $scope.chartTooltip.viewData = true;\n                $timeout(function(){\n\n                    if($scope.chartTooltip.popup) {\n                        $scope.chartTooltip.popup.update();\n                    }\n                })\n            },\n            closeData: function(){\n                $scope.chartTooltip.viewData = false;\n                $timeout(function(){\n\n                    if($scope.chartTooltip.popup) {\n                        $scope.chartTooltip.popup.update();\n                    }\n                })\n            },\n            hide: function () {\n                if (this.visible) {\n                    var that = this;\n                    $timeout(function(){\n                        that.visible = false;\n                        that.active = false;\n                    })\n                }\n            },\n            updatePosition: function (point) {\n                var chartContainer = $('#chart-container');\n                var offset = chartContainer.offset();\n                var tooltip = $('.chart-tooltip');\n                var left = offset.left + ((point.tooltipPos) ? point.tooltipPos[0] : point.plotX);\n                var top = offset.top + ((point.tooltipPos) ? point.tooltipPos[1] : point.plotY);\n                var arrowLeftPosition = (tooltip.width() / 2 - 10);\n\n                if(!point.series) return;\n\n                left += point.series.chart.plotLeft - 10;\n\n                if ((rawData ? rawData.chartType : $scope.vizSummary.chartType) === CHART_TYPES.BAR) {\n\n                    left -= ((tooltip.width() / 2)) - 10;\n                    top = (top - tooltip.height() + 22);\n\n                    if (!rawData && $scope.vizSummary.enabledMultiAxis) {\n                        top += point.series.chart.plotTop - 40\n                    }\n\n                } else {\n                    left -= ((tooltip.width() / 2) - 8);\n                    top = (top - tooltip.height() - 10);\n                }\n\n                // check out on window\n                var leftOutside =  ((left + tooltip.width()) - (chartContainer.width() + offset.left));\n                var rightOutside =  (offset.left - left);\n\n                if (leftOutside > 0) {\n                    left -= leftOutside;\n\n                    arrowLeftPosition += leftOutside;\n                } else if (rightOutside > 0) {\n                    left += rightOutside;\n\n                    arrowLeftPosition -= rightOutside;\n                }\n\n                // check out on top\n                if (top < tooltip.height()) {\n                    top += (tooltip.height() + 35);\n                    this.direction = 'top';\n                } else {\n                    this.direction = 'bottom';\n                }\n\n\n                if (modalClass) {\n                    var modalOffset = $(modalClass+' .modal-body').offset();\n\n                    left -= modalOffset.left;\n                    top -= modalOffset.top - 65;\n                }\n\n                tooltip.css({ left: left, top: top });\n\n                $('.chart-tooltip .arrow').css({ left: arrowLeftPosition });\n            },\n            activateEvents: function () {\n                if (!this.isEnableEvents) {\n                    $('.chart-tooltip').css('pointer-events', 'auto');\n                    this.isEnableEvents = true;\n                }\n            },\n            deactivateEvents: function () {\n                if (this.isEnableEvents) {\n                    $('.chart-tooltip').css('pointer-events', 'none');\n                    this.isEnableEvents = false;\n                }\n            },\n            activateVisible: function () {\n                if (!this.visible) {\n                    this.visible = true;\n                }\n            },\n            resetTimeout: function () {\n                if (this.hidePromise) {\n                    $timeout.cancel($scope.chartTooltip.hidePromise);\n                }\n            }\n        }\n    }\n\n    function isAllowedDataForChartType(type, $scope, colsTypes) {\n        var groups = _.filter($scope.vizSummary.xAxisShows, function(s){\n                return s.field != '$$row_number';\n            }),\n            cols = $scope.vizSummary.yAxisShows;\n        switch (type){\n            case CHART_TYPES.COLUMN:\n                return true;\n            case CHART_TYPES.BAR:\n                return true;\n            case CHART_TYPES.LINE:\n                return true;\n            case CHART_TYPES.AREA:\n                return true;\n            case CHART_TYPES.PIE:\n                return groups.length > 0;\n            case CHART_TYPES.MAP:\n                if (groups.length > 0 && !$scope.vizSummary.hltd) {\n                    var field = colsTypes[groups[0].field].toLowerCase();\n                    return field == 'location_lat_lon' || !field.indexOf('location');\n                }\n                return false;\n            case CHART_TYPES.SCATTER:\n                return groups.length == 1 && cols.length == 1 && !$scope.vizSummary.hltd;\n            case CHART_TYPES.TABLE:\n            case CHART_TYPES.LIST:\n                return true;\n            default:\n                throw \"Unknown chart type: \" + type;\n        }\n    }\n\n    function calculateCoordsForRegressions(data, regressionType, regData, allData) {\n        var minY = data[0].y;\n        var maxY = data[data.length - 1].y;\n        var plusY = (maxY - minY) / data.length;\n        var minX = data[0].x;\n        var maxX = data[data.length - 1].x;\n        var plusX = (maxX - minX) / data.length;\n\n        function calculateY(equation, x, i) {\n            switch(regressionType) {\n                case REGRESSION_TYPES.LINEAR:\n                    return i == 0 ? minY : minY+=plusY;\n                case REGRESSION_TYPES.EXPONENTIAL:\n                    return equation[0] * Math.exp(equation[1] * x);\n                case REGRESSION_TYPES.LOGARITHMIC:\n                    return equation[0] + equation[1] * Math.log(x);\n                case REGRESSION_TYPES.POWER:\n                    return equation[0] * Math.pow(x, equation[1]);\n                case REGRESSION_TYPES.POLYNOMIAL:\n                    return equation[2] * Math.pow(x, 2) + equation[1] * x + equation[0];\n            }\n        }\n\n        var forCalc = JSON.stringify({\n            string: regData.string,\n            equation: regData.equation,\n            type: regressionType\n        });\n\n        return {name: regData.string + ' RÂ²='+regData.r2.toFixed(2) + ' <a onclick=\\'$scope.regressionCalculator(event, ' + JSON.stringify(forCalc) + ')\\'>Calculate</a>', type: 'spline', data: (_.map(data, function(o, i) {\n            return {\n                x: parseFloat((i == 0 ? minX : minX+=plusX).toFixed(2)),\n                y: parseFloat(calculateY(regData.equation, minX, i).toFixed(2)),\n                o: allData[i]\n            }\n        })).concat([{x: parseFloat((minX+=plusX).toFixed(2)), y: parseFloat((calculateY(regData.equation, minX, data[data.length])).toFixed(2)), o: allData[allData.length - 1]}])}\n    }\n\n    function removeCalculate(str) {\n        var startIndex = str.indexOf(\"<a onclick='$scope.regressionCalculator\")\n        var endIndex = str.indexOf(\"Calculate</a>\");\n\n        if(startIndex != -1 && endIndex != -1) {\n            str = str.slice(0, startIndex);\n        }\n        return str;\n    }\n\n    return {\n        CHART_TYPES: CHART_TYPES,\n        REGRESSION_TYPES: REGRESSION_TYPES,\n        REGRESSION_TYPE_OPTIONS: REGRESSION_TYPE_OPTIONS,\n        getFullName: getFullName,\n        getAggIndex: getAggIndex,\n        defaultChartOptions: defaultChartOptions,\n        chartTooltip: chartTooltip,\n        isAllowedDataForChartType: isAllowedDataForChartType,\n        calculateCoordsForRegressions: calculateCoordsForRegressions,\n        removeCalculate: removeCalculate\n    }\n});"]}